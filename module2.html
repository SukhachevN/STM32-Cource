<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <title>Методические указания.</title>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>Модуль 2</h1>
        <h2>Содержание</h2>
        <nav>
          <ol>
            <li><a href="#introduction">Введение</a></li>
            <li>
              <a href="#module2-1">Работа с 7-ми сегментным дисплеем</a>
            </li>
            <li>
              <a href="#module2-2">Работа с ЖКИ</a>
            </li>
            <li>
              <a href="#module2-3"
                >Работа с клавиатурой. Вывод номера нажатой клавиши.</a
              >
            </li>
            <li><a href="#module2-4">Калькулятор</a></li>
          </ol>
        </nav>
      </header>
      <section id="introduction">
        <h2>Введение</h2>
        <section>
          <h3>Теоретическая часть</h3>
          TODO
        </section>
      </section>
      <section id="module2-1">
        <h3>Модуль 2.1. Работа с 7-ми сегментным индикатором</h3>
        <h4>Задание</h4>
        <p>
          Вывести на 7-ми сегментный индикатор заданную последовательность чисел
          с задержкой 1 сек.
        </p>
        <ol class="math">
          <li>Числа: A,2,F,8,1 тип индикатора: BCD, порты: PA0,PB0,PB1,PC13</li>
          <li>
            Числа: 9,B,4,8,5 тип индикатора: DIGITAL, порты:
            PA0,PA1,PA2,PC3,PC4,PC5,PD1
          </li>
          <li>Числа: 1,4,8,A,F тип индикатора: BCD, порты: PB0,PB5,PB8,PD10</li>
          <li>
            Числа: 0,C,D,3,6 тип индикатора: DIGITAL, порты:
            PA7,PA8,PC1,PC7,PC2,PC12,PA9
          </li>
          <li>Числа: 1,C,B,4,E тип индикатора: BCD, порты: PE15,PC4,PB3,PA0</li>
          <li>
            Числа: F,D,E,C,A тип индикатора: DIGITAL, порты:
            PE6,PD13,PA0,PC4,PB2,PC1,PD5
          </li>
          <li>
            Числа: 2,0,7,5,B тип индикатора: BCD, порты: PA3,PE4,PD14,PC15
          </li>
          <li>
            Числа: 9,E,B,1,3 тип индикатора: DIGITAL, порты:
            PС9,PB3,PE0,PA5,PB11,PE7,PC4
          </li>
          <li>
            Числа: 6,5,E,F,2 тип индикатора: BCD, порты: PA3,PE4,PD14,PC15
          </li>
          <li>
            Числа: 7,8,9,A,B тип индикатора: DIGITAL, порты:
            PA1,PB2,PC3,PD4,PE6,PE6,PC9
          </li>
          <li>
            Числа: 4,2,8,D,A тип индикатора: BCD, порты: PB0,PA11,PE14,PC7
          </li>
          <li>
            Числа: 8,D,0,1,3 тип индикатора: DIGITAL, порты:
            PA1,PB2,PC3,PD4,PE6,PE6,PC9
          </li>
          <li>Числа: E,C,1,5,7 тип индикатора: BCD, порты: PE8,PA3,PE9,PB13</li>
        </ol>
        <p>
          Вывод цифры "D" и "B" сделать как "d" и "b" для вариантов с типом
          индикатора DIGITAL.<br />
          Порты расположены в порядке сверху вниз для типа DIGITAL, и слева
          направо для типа BCD
        </p>
        <h4>Подключение 7-ми сегментного индикатора</h4>
        <p>
          Будут рассмотрены два типа 7-ми сегментных индикаторов: 1-ый тип
          принимает 7-ми сегментные коды, в соответствии с чем зажигает
          соответствующие сегменты. 2-ой тип принимает 4х разрядный двоичный
          код, в зависимости от которого выводятся числа от 0 до F
        </p>
        <p>
          Рассмотрим оба варианта. Создадим проект для микроконтроллера
          <b>STM32F401VE</b>
        </p>
        <p>
          Порты PD0-PD6 и PD10-PD13 назначаем GPIO_Output, это необходимо чтобы
          подавать сигналы на эти порты
        </p>
        <div class="imageBlock">
          <img src="./images/module_2/introduction-1.png" />
          <p>Рисунок 1 Назначение портов для вывода</p>
        </div>
        <p>По итогу должно получиться следующее</p>
        <div class="imageBlock">
          <img src="./images/module_2/introduction-2.png" />
          <p>Рисунок 2 Назначение портов для вывода</p>
        </div>
        <p>
          Чтобы осуществить вывод на нужный порт, необходимо использовать
          следующую команду
        </p>
        <pre>
              HAL_GPIO_WritePin(GPIOX,GPIO_PIN_X,value);
            </pre
        >
        <p>
          GPIOX - X это буква порта, для портов A это будет GPIOA, для портов B
          соответственно GPIOB и так далее. GPIO_PIN_X - X это номер порта, для
          выбора порта с номером 0 это будет GPIO_PIN_0 и так далее. value - это
          значение, которое подаём на порт 0 или 1.
        </p>
        <p>Напишем код для вывода числа 9 на 7-ми сегментный индикатор</p>
        <pre>
              // 7 seg code
              HAL_GPIO_WritePin(GPIOD,GPIO_PIN_0,1);
              HAL_GPIO_WritePin(GPIOD,GPIO_PIN_1,1);
              HAL_GPIO_WritePin(GPIOD,GPIO_PIN_2,1);
              HAL_GPIO_WritePin(GPIOD,GPIO_PIN_3,1);
              HAL_GPIO_WritePin(GPIOD,GPIO_PIN_4,0);
              HAL_GPIO_WritePin(GPIOD,GPIO_PIN_5,1);
              HAL_GPIO_WritePin(GPIOD,GPIO_PIN_6,1);
              // BCD code
              HAL_GPIO_WritePin(GPIOD,GPIO_PIN_10,1);
              HAL_GPIO_WritePin(GPIOD,GPIO_PIN_11,0);
              HAL_GPIO_WritePin(GPIOD,GPIO_PIN_12,0);
              HAL_GPIO_WritePin(GPIOD,GPIO_PIN_13,1);
            </pre
        >
        <p>
          Компилируем проект, не забыв включить вывод hex файла в настройках
        </p>
        <p>
          Перейдём к созданию проекта в среде Proteus. Аналогично модулю 1
          добавляем микроконтроллер <b>STM32F401VE</b>. Далее в добавим 7-ми
          сегментные индикаторы. Для этого необходимо ввести "7SEG-BCD" и потом
          "7SEG-DIGITAL" в поисковую строку.
        </p>
        <p>
          Индикатор с 7-ю входами подключаем к портам PD0-PD6, индикатор BCD к
          портам PD10-PD13.
        </p>
        <div class="imageBlock">
          <img src="./images/module_2/introduction-3.png" />
          <p>Рисунок 3 Работа 7-ми сегментных индикаторов</p>
        </div>
        <p>
          Вернёмся к заданию. Чтобы реализовать тестирование включаем UART, если
          он не был включен. Также подключаем COMPIM (Инструкция по настройке
          приведена в модуле 1).
        </p>
        <p>Задержку можно формировать следующей командой:</p>
        <pre>
          HAL_Delay(value);
        </pre>
        <p>value значение задержки в мс.</p>
        <p>
          Для корректного тестирования, подавать данные на компорт в следующем
          формате
        </p>
        <pre>
          HAL_UART_Transmit(&huart1, (uint8_t*)buffer, sprintf(buffer, "%d...%d", value1, ..., valueN), 100);
        </pre>
      </section>
    </div>
  </body>
</html>
